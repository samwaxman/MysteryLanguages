#lang racket
(require
  (rename-in
   racket [+ r+] [- r-] [* r*] [/ r/] [let r-let])
  "../ML-Helpers.rkt"
  "NumbersSetup.rkt"
  "../testPrinter.rkt")
(provide
 (rename-out [ML-let #%let] [ML+ #%+] [ML- #%-][ML* #%*] [ML/ #%/]
             ;Arity app is defined in ML-Helpers
             ;It display better arity error messages
             [#%arity-app #%app]
             [my-mod #%module-begin])
 #%top
 #%datum
 #%id
 #%block
 NumberMode
 (all-from-out "../testPrinter.rkt"))


;THIS LANGUAGE'S READER READS IN ALL NUMBERS AS EXACT

;This flag let's the reader know how we want
;it to read numbers in
(define NumberMode 'exact)

(define (divide a b)
  (if (eq? 0 b)
      (if (eq? 0 a) +nan.0 (r* +inf.0 (sgn a)))
      (r/ a b)))
(define (add a b)
  (r+ a b))
(define (subtract a b)
  (r- a b))
(define (multiply a b)
  (r* a b))

(define-syntax-rule (my-mod body ...)
  (#%module-begin
   (setup-printer)
   (add-setter add)
   (subtract-setter subtract)
   (multiply-setter multiply)
   (divide-setter divide)
   (let ()
     body ...)))


